function IsPrice(c){var a,b=c.match(/^([1-9][0-9]*|0)(\.[0-9]{0,2})?$/g);for(a in b){if(b.hasOwnProperty(a)){if(b[a]===c){return true}}}return false}function ValidateEmail(b){var a=/^[\w][\w\._\-]*@(?:[\w\-]+\.?)*[\w]\.[a-zA-Z]{2,4}$/;return a.test(b)}function handle_ajax_post_back(d,g,f,e){var c,b,a=jQuery.parseJSON(d);if(a.status){switch(a.status){case"error":jQuery(".kmn-error").html(a.error).show();if(a.field){b=a.field.split(";");for(c=0;c<b.length;c++){if(document.getElementById(g+b[c])){jQuery("#"+g+b[c]).css("border","2px solid red")}}}jQuery(f).hide();jQuery(e).slideToggle(400);break;case"success":window.location.href=jQuery(e).attr("action");break}}}function on_ad_size_change(c){var b=jQuery("#"+c+"adsize").val(),a=jQuery("#"+c+"cpm").attr("checked");if(a!=="undefined"&&b!=="300x250"&&b!=="728x90"&&b!=="160x600"){jQuery("#"+c+"cpm-notice").show(500);jQuery("#"+c+"cpm-warning").hide(500);jQuery("#"+c+"cpm").attr("checked",false)}else{jQuery("#"+c+"cpm-notice").hide(500);jQuery("#"+c+"cpm-warning").show(500);jQuery("#"+c+"cpm").attr("checked",true)}}jQuery(document).ready(function(){var a=function(d){var b,c=jQuery("#"+d).attr("checked");if(!c){jQuery("#"+d+"-div").slideToggle(200);b=(d==="kmn-billing")?"kmn-self":"kmn-billing";jQuery("#"+b+"-div").slideToggle(200);jQuery("#"+b).attr("checked",true)}};jQuery("#kmn-cpm").click(function(){var b=jQuery(this).attr("checked");if(!b){jQuery("#kmn-cpm-notice").hide(500);jQuery("#kmn-cpm-warning").show(500)}else{on_ad_size_change("kmn-")}});jQuery("#kmn-adsize").change(function(){on_ad_size_change("kmn-")}).keypress(function(){jQuery(this).change()});jQuery("#kmn-a-cpm").click(function(){var b=jQuery(this).attr("checked");if(!b){jQuery("#kmn-a-cpm-notice").hide(500);jQuery("#kmn-a-cpm-warning").show(500)}else{on_ad_size_change("kmn-a-")}});jQuery("#kmn-a-adsize").change(function(){on_ad_size_change("kmn-a-")}).keypress(function(){jQuery(this).change()});jQuery("#kmn-self").click(function(){a("kmn-self")});jQuery("#kmn-billing").click(function(){a("kmn-billing")});jQuery("a[rel=help-tip]").bt({positions:["right","top"],showTip:function(b){jQuery(b).fadeIn(200)},hideTip:function(b,c){jQuery(b).animate({opacity:0},0,c)},shrinkToFit:false,hoverIntentOpts:{interval:0,timeout:0},fill:"#FFF",width:200,height:140,shadow:true,shadowColor:"rgba(0,0,0,.9)"});jQuery("a[rel=cpm-tip]").bt({positions:["right","top"],showTip:function(b){jQuery(b).fadeIn(200)},hideTip:function(b,c){jQuery(b).animate({opacity:0},0,c)},shrinkToFit:false,hoverIntentOpts:{interval:0,timeout:0},fill:"#FFF",width:300,height:140,shadow:true,shadowColor:"rgba(0,0,0,.9)"});jQuery("a[rel=adsense-tip]").bt(jQuery("#adsense-help-text").html(),{trigger:"click",fill:"#FFF",shrinkToFit:true,cornerRadius:10,strokeWidth:0,shadow:true,shadowOffsetX:3,shadowOffsetY:3,shadowBlur:8,shadowColor:"rgba(0,0,0,.9)",shadowOverlap:false,clickAnywhereToClose:true,noShadowOpts:{strokeStyle:"#999",strokeWidth:2},positions:["right","top"]});jQuery("a[rel=kmn-account-exists]").click(function(){jQuery("a[rel=adsense-tip]").btOff();jQuery(".kmn-error").html("").hide();jQuery(".form-table input[type=text], .form-table input[type=password], .form-table textarea").css("border","1px solid #dfdfdf");jQuery("#kmn-create-account").hide(500);jQuery("#kmn-add-site").show(500)});jQuery("a[rel=kmn-create-account]").click(function(){jQuery("a[rel=adsense-tip]").btOff();jQuery(".kmn-error").html("").hide();jQuery(".form-table input[type=text], .form-table input[type=password], .form-table textarea").css("border","1px solid #dfdfdf");jQuery("#kmn-add-site").hide(500);jQuery("#kmn-create-account").show(500)});jQuery("#kmn-sidebar").click(function(){if(jQuery(this).attr("checked")){jQuery("#kmn-other").attr("checked",false);jQuery("#kmn-sidebar-div").show(300);jQuery("#kmn-other-div").hide(300)}else{jQuery("#kmn-other").attr("checked",true);jQuery("#kmn-other-div").show(300);jQuery("#kmn-sidebar-div").hide(300)}jQuery("#kmn-pos-div").css("border","none")});jQuery("#kmn-other").click(function(){if(jQuery(this).attr("checked")){jQuery("#kmn-sidebar").attr("checked",false);jQuery("#kmn-other-div").show(300);jQuery("#kmn-sidebar-div").hide(300)}else{jQuery("#kmn-sidebar").attr("checked",true);jQuery("#kmn-sidebar-div").show(300);jQuery("#kmn-other-div").hide(300)}jQuery("#kmn-pos-div").css("border","none")});jQuery("#kmn-a-sidebar").click(function(){if(jQuery(this).attr("checked")){jQuery("#kmn-a-other").attr("checked",false);jQuery("#kmn-a-sidebar-div").show(300);jQuery("#kmn-a-other-div").hide(300)}else{jQuery("#kmn-a-other").attr("checked",true);jQuery("#kmn-a-other-div").show(300);jQuery("#kmn-a-sidebar-div").hide(300)}jQuery("#kmn-a-pos-div").css("border","none")});jQuery("#kmn-a-other").click(function(){if(jQuery(this).attr("checked")){jQuery("#kmn-a-sidebar").attr("checked",false);jQuery("#kmn-a-other-div").show(300);jQuery("#kmn-a-sidebar-div").hide(300)}else{jQuery("#kmn-a-sidebar").attr("checked",true);jQuery("#kmn-a-sidebar-div").show(300);jQuery("#kmn-a-other-div").hide(300)}jQuery("#kmn-a-pos-div").css("border","none")});jQuery("#kmn-submit").click(function(){jQuery("a[rel=adsense-tip]").btOff();jQuery(".kmn-error").html("").hide();jQuery(".form-table input[type=text], .form-table input[type=password], .form-table textarea").css("border","1px solid #dfdfdf");if(!ValidateEmail(jQuery("#kmn-username").val())){jQuery(".kmn-error").html("Please insert valid email address").show();jQuery("#kmn-username").css("border","2px solid red");return false}if(document.getElementById("kmn-password")){if(jQuery.trim(jQuery("#kmn-password").val()).length<7){jQuery(".kmn-error").html("Your password must contain at least 8 characters.").show();jQuery("#kmn-password").css("border","2px solid red");return false}}if(document.getElementById("kmn-other")&&document.getElementById("kmn-sidebar")){if(!jQuery("#kmn-other").attr("checked")&&!jQuery("#kmn-sidebar").attr("checked")){jQuery(".kmn-error").html("Please select where in your blog you plan to dispaly the ads").show();jQuery("#kmn-pos-div").css("border","1px solid red");jQuery(".kmn-position").hide();return false}}if(document.getElementById("kmn-adsense")){if(jQuery.trim(jQuery("#kmn-adsense").val()).length<7){jQuery(".kmn-error").html("Please insert your Google AdSense script").show();jQuery("#kmn-adsense").css("border","2px solid red");return false}}var b=jQuery.trim(jQuery("#kmn-price").val());if(IsPrice(b)===false){jQuery(".kmn-error").html("Invalid price format: please set a valid format.").show();jQuery("#kmn-price").css("border","2px solid red");return false}if(b<=0){jQuery(".kmn-error").html("Invalid price: please insert single ad unit price.").show();jQuery("#kmn-price").css("border","2px solid red");return false}if(jQuery("#kmn-self").attr("checked")==="checked"){if(!ValidateEmail(jQuery("#kmn-paypal").val())){jQuery(".kmn-error").html("Please insert valid PayPal account (email address)").show();jQuery("#kmn-paypal").css("border","2px solid red");return false}}if(jQuery("#kmn-toc").attr("checked")!=="checked"){jQuery(".kmn-error").html("You must agree to Komoona <strong>Terms of Service</strong> to create an account.").show();return false}jQuery("#wait-div").show();jQuery("#create-kmn-account").slideToggle(400);jQuery.ajax({type:"POST",url:jQuery("#create-kmn-account").attr("action"),data:jQuery("#create-kmn-account").serialize(),success:function(c){handle_ajax_post_back(c,"kmn-","#wait-div","#create-kmn-account")},error:function(){jQuery(".kmn-error").html("General server error.<br/>Please contact <a href=mailto:support@komoona.com:>Support@Komoona.com</a>");jQuery("#wait-div").hide();jQuery("#create-kmn-account").slideToggle(400)}});return false});jQuery("#kmn-a-submit").click(function(){jQuery("a[rel=adsense-tip]").btOff();jQuery(".kmn-error").html("").hide();jQuery(".form-table input[type=text], .form-table input[type=password], .form-table textarea").css("border","1px solid #dfdfdf");if(!ValidateEmail(jQuery("#kmn-a-username").val())){jQuery(".kmn-error").html("Please insert valid email address").show();jQuery("#kmn-a-username").css("border","2px solid red");return false}if(document.getElementById("kmn-a-password")){if(jQuery.trim(jQuery("#kmn-a-password").val()).length<5){jQuery(".kmn-error").html("Please insert a valid Komoona password.").show();jQuery("#kmn-a-password").css("border","2px solid red");return false}}if(document.getElementById("kmn-a-other")&&document.getElementById("kmn-a-sidebar")){if(!jQuery("#kmn-a-other").attr("checked")&&!jQuery("#kmn-a-sidebar").attr("checked")){jQuery(".kmn-error").html("Please select where in your blog you plan to dispaly the ads").show();jQuery("#kmn-a-pos-div").css("border","1px solid red");jQuery(".kmn-position").hide();return false}}if(document.getElementById("kmn-a-adsense")){if(jQuery.trim(jQuery("#kmn-a-adsense").val()).length<7){jQuery(".kmn-error").html("Please insert your Google AdSense script").show();jQuery("#kmn-a-adsense").css("border","2px solid red");return false}}var b=jQuery.trim(jQuery("#kmn-a-price").val());if(IsPrice(b)===false){jQuery(".kmn-error").html("Invalid price format: please set a valid format.").show();jQuery("#kmn-a-price").css("border","2px solid red");return false}if(b<=0){jQuery(".kmn-error").html("Invalid price: please insert single ad unit price.").show();jQuery("#kmn-a-price").css("border","2px solid red");return false}jQuery("#wait-div-a").show();jQuery("#add-kmn-site").slideToggle(400);jQuery.ajax({type:"POST",url:jQuery("#add-kmn-site").attr("action"),data:jQuery("#add-kmn-site").serialize(),success:function(c){handle_ajax_post_back(c,"kmn-a-","#wait-div-a","#add-kmn-site")},error:function(){jQuery(".kmn-error").html("General server error.<br/>Please contact <a href=mailto:support@komoona.com:>Support@Komoona.com</a>");jQuery("#wait-div").hide();jQuery("#add-kmn-site").slideToggle(400)}});return false});jQuery("a[rel=kmn-expand-div]").click(function(){var b=jQuery(this).find("img").attr("src");if(b.indexOf("expand")!==-1){jQuery(this).find("img").attr("src",b.replace("expand","collapse"));jQuery(this).find("img").attr("title","collapse")}else{jQuery(this).find("img").attr("src",b.replace("collapse","expand"));jQuery(this).find("img").attr("title","expand")}jQuery("#kmn-advanced-settings").slideToggle(300)});jQuery(".kmn-advanced-header").click(function(){var b=jQuery("a[rel=kmn-expand-div]").find("img").attr("src");if(b.indexOf("expand")!==-1){jQuery("a[rel=kmn-expand-div]").find("img").attr("src",b.replace("expand","collapse"));jQuery("a[rel=kmn-expand-div]").find("img").attr("title","collapse")}else{jQuery("a[rel=kmn-expand-div]").find("img").attr("src",b.replace("collapse","expand"));jQuery("a[rel=kmn-expand-div]").find("img").attr("title","expand")}jQuery("#kmn-advanced-settings").slideToggle(300)})});